# AWS::EC2::SecurityGroupIngress

보안 그룹에 인바운드 규칙을 추가합니다.

인바운드 규칙은 인스턴스가 지정된 IPv4 또는 IPv6 CIDR 주소 범위 또는 지정된 보안 그룹과 연결된 인스턴스에서 트래픽을 수신하도록 허용합니다.

, `CidrIp`, , `CidrIpv6`, `SourcePrefixListId`또는 `SourceSecurityGroupId`.`SourceSecurityGroupName` 속성 중 하나만 지정해야 합니다.

각 규칙에 대한 프로토콜(예: TCP)을 지정합니다. TCP 및 UDP의 경우 포트 또는 포트 범위도 지정해야 합니다. ICMP/ICMPv6의 경우 ICMP/ICMPv6 유형 및 코드도 지정해야 합니다. -1을 사용하여 모든 유형 또는 모든 코드를 의미할 수 있습니다.

소스 보안 그룹(`SourcePrefixListId`, `SourceSecurityGroupId`, 또는 `SourceSecurityGroupName`) 또는 CIDR 범위(`CidrIp` 또는 `CidrIpv6` )를 지정해야 합니다. 이러한 파라미터 중 하나를 지정하지 않으면 스택이 성공적으로 시작되지만 규칙이 보안 그룹에 추가되지 않습니다.

규칙 변경 사항은 가능한 한 빨리 보안 그룹 내의 인스턴스로 전파됩니다. 그러나 약간의 지연이 발생할 수 있습니다.

## 통사론

AWS CloudFormation 템플릿에서 이 엔터티를 선언하려면 다음 구문을 사용합니다.

### JSON (영문)

```
{
  "Type" : "AWS::EC2::SecurityGroupIngress",
  "Properties" : {
      "CidrIp" : String,
      "CidrIpv6" : String,
      "Description" : String,
      "FromPort" : Integer,
      "GroupId" : String,
      "GroupName" : String,
      "IpProtocol" : String,
      "SourcePrefixListId" : String,
      "SourceSecurityGroupId" : String,
      "SourceSecurityGroupName" : String,
      "SourceSecurityGroupOwnerId" : String,
      "ToPort" : Integer
    }
}
```

## 속성

`CidrIp`  
CIDR 형식의 IPv4 주소 범위입니다.  
소스 보안 그룹(`SourcePrefixListId` 또는 `SourceSecurityGroupId`) 또는 CIDR 범위(`CidrIp` 또는 `CidrIpv6` )를 지정해야 합니다.  
특정 액세스 시나리오에 대해 보안 그룹에 추가할 수 있는 규칙의 예는 Amazon EC2 사용 설명서의 다양한 사용 사례에 대한 보안 그룹 규칙을 참조하세요\**.  
*필수 항목 *여부: 아니요  
*유형*: 문자열  
*업데이트 필요 사항\*: 바꿔 놓음

`CidrIpv6`  
CIDR 형식의 IPv6 주소 범위입니다.  
소스 보안 그룹(`SourcePrefixListId` 또는 `SourceSecurityGroupId`) 또는 CIDR 범위(`CidrIp` 또는 `CidrIpv6` )를 지정해야 합니다.  
특정 액세스 시나리오에 대해 보안 그룹에 추가할 수 있는 규칙의 예는 Amazon EC2 사용 설명서의 다양한 사용 사례에 대한 보안 그룹 규칙을 참조하세요\**.  
*필수 항목 *여부: 아니요  
*유형*: 문자열  
*업데이트 필요 사항\*: 바꿔 놓음

`Description`  
수신(인바운드) 보안 그룹 규칙에 대한 설명을 업데이트합니다. 기존 설명을 바꾸거나 이전에 설명이 없었던 규칙에 설명을 추가할 수 있습니다.  
제약 조건: 최대 255자까지 입력할 수 있습니다. 허용되는 문자는 a-z, A-Z, 0-9, 공백 및 .\_-:/()#,@[]+=;{}입니다! $\*  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 중단 없음

`FromPort`  
TCP 및 UDP 프로토콜의 시작 포트 범위 또는 ICMP/ICMPv6 유형 번호입니다. 값은 `-1` 모든 ICMP/ICMPv6 유형을 나타냅니다. 모든 ICMP/ICMPv6 유형을 지정하는 경우 모든 코드를 지정해야 합니다.  
ICMP 및 포트를 사용하는 모든 프로토콜에 사용합니다.  
*필수 항목 *여부: 아니요  
_유형_: Integer  
_업데이트 필요 사항_: 바꿔 놓음

`GroupId`  
보안 그룹의 ID입니다.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 바꿔 놓음

`GroupName`  
보안 그룹의 이름입니다.  
제약 조건: 최대 255자까지 입력할 수 있습니다. 로 시작할 수 없습니다`sg-`.  
유효한 문자: a-z, A-Z, 0-9, 공백 및 .\_-:/()#,@[]+=&;{}! $\*  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 바꿔 놓음

`IpProtocol`  
IP 프로토콜 이름(`tcp`, `udp`, `icmp`, `icmpv6`) 또는 번호(프로토콜 번호 참조).  
`-1` 모든 프로토콜을 지정하는 데 사용합니다. 보안 그룹 규칙에 권한을 부여할 때 `-1`, `tcp`, `udp`또는 `icmp` 지정한 포트 범위에 관계없이 모든 포트에서 트래픽을 허용하는 대신 또는 이외의 프로토콜 번호를 `icmpv6` 지정합니다 . `tcp`, `udp`및 `icmp`의 경우 포트 범위를 지정해야 합니다. 의 경우 `icmpv6`포트 범위는 선택 사항이며, 포트 범위를 생략하면 모든 유형 및 코드에 대한 트래픽이 허용됩니다.  
_필수 항목 여부_: 예  
_유형_: 문자열  
_업데이트 필요 사항_: 바꿔 놓음

`SourcePrefixListId`  
접두사 목록의 ID입니다.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 바꿔 놓음

`SourceSecurityGroupId`  
보안 그룹의 ID입니다. 보안 그룹 ID 또는 보안 그룹 이름을 지정해야 합니다. 기본이 아닌 VPC에 있는 보안 그룹의 경우 보안 그룹 ID를 지정해야 합니다.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 바꿔 놓음

`SourceSecurityGroupName`  
[기본 VPC] 소스 보안 그룹의 이름입니다. 보안 그룹 ID 또는 보안 그룹 이름을 지정해야 합니다. 그룹 이름은 IP 주소 범위와 함께 지정할 수 없습니다. 전체 ICMP, UDP 및 TCP 액세스 권한을 부여하는 규칙을 만듭니다.  
기본이 아닌 VPC에 있는 보안 그룹의 경우 그룹 ID를 지정해야 합니다.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 바꿔 놓음

`SourceSecurityGroupOwnerId`  
[기본이 아닌 VPC] 소스 보안 그룹이 다른 계정에 있는 경우 소스 보안 그룹의 AWS 계정 ID입니다. IP 주소 범위로 이 속성을 지정할 수 없습니다. 전체 ICMP, UDP 및 TCP 액세스 권한을 부여하는 규칙을 만듭니다.  
`SourceSecurityGroupName` 또는 `SourceSecurityGroupId` 를 지정 하고 해당 보안 그룹을 스택을 생성하는 계정이 아닌 다른 계정이 소유하고 있는 경우 다음을 지정해야 하며, `SourceSecurityGroupOwnerId`그렇지 않으면 이 속성은 선택 사항입니다.  
_필수_: 조건부  
_유형_: 문자열  
_업데이트 필요 사항_: 바꿔 놓음

`ToPort`  
TCP 및 UDP 프로토콜 또는 ICMP/ICMPv6 코드에 대한 포트 범위의 끝입니다. 의 값은 `-1` 지정된 ICMP 유형에 대한 모든 ICMP/ICMPv6 코드를 나타냅니다. 모든 ICMP/ICMPv6 유형을 지정하는 경우 모든 코드를 지정해야 합니다.  
ICMP 및 포트를 사용하는 모든 프로토콜에 사용합니다.  
*필수 항목 *여부: 아니요  
_유형_: Integer  
_업데이트 필요 사항_: 바꿔 놓음

## 예제

### 송신 및 수신 규칙이 있는 VPC 보안 그룹

경우에 따라 대상(대상) 보안 그룹에 대한 트래픽을 허용하는 아웃바운드 규칙을 추가하려는 시작(소스) 보안 그룹이 있을 수 있습니다. 대상 보안 그룹에는 소스 보안 그룹의 트래픽을 허용하는 인바운드 규칙도 필요합니다. Ref 함수를 사용하여 각 보안 그룹에 대한 아웃바운드 및 인바운드 규칙을 지정할 수 없습니다. 이렇게 하면 순환 종속성이 생성됩니다. 서로 종속된 두 개의 리소스를 가질 수 없습니다. 대신, 송신 및 수신 리소스를 사용하여 다음 템플릿 예제와 같이 이러한 아웃바운드 및 인바운드 규칙을 선언합니다.

#### JSON (영문)

```
{
    "Resources": {
        "SourceSG": {
            "Type": "AWS::EC2::SecurityGroup",
            "Properties": {
                "VpcId" : "vpc-1a2b3c4d",
                "GroupDescription": "Sample source security group"
            }
        },
        "TargetSG": {
            "Type": "AWS::EC2::SecurityGroup",
            "Properties": {
                "VpcId" : "vpc-1a2b3c4d",
                "GroupDescription": "Sample target security group"
            }
        },
        "OutboundRule": {
            "Type": "AWS::EC2::SecurityGroupEgress",
            "Properties":{
                "IpProtocol": "tcp",
                "FromPort": 0,
                "ToPort": 65535,
                "DestinationSecurityGroupId": {
                    "Fn::GetAtt": [
                        "TargetSG",
                        "GroupId"
                    ]
                },
                "GroupId": {
                    "Fn::GetAtt": [
                        "SourceSG",
                        "GroupId"
                    ]
                }
            }
        },
        "InboundRule": {
            "Type": "AWS::EC2::SecurityGroupIngress",
            "Properties":{
                "IpProtocol": "tcp",
                "FromPort": 0,
                "ToPort": 65535,
                "SourceSecurityGroupId": {
                    "Fn::GetAtt": [
                        "SourceSG",
                        "GroupId"
                    ]
                },
                "GroupId": {
                    "Fn::GetAtt": [
                        "TargetSG",
                        "GroupId"
                    ]
                }
            }
        }
    }
}
```

### 피어링된 VPC의 보안 그룹에서 발생하는 트래픽 허용

다음 예제에서는 시작(소스) 보안 그룹에서 대상(대상) 보안 그룹으로의 단방향 트래픽을 허용합니다. 그러나 이 예에서 보안 그룹은 AWS 계정 간에 피어링된 VPC에 있습니다. 예를 들어, 한 AWS 계정에서 다른 계정에서 진단을 실행하는 데 사용할 보안 스캔 리소스를 생성하는 경우 교차 계정 트래픽을 허용할 수 있습니다. 이 예제에서는 다른 AWS 계정의 소스 보안 그룹에서 수신되는 트래픽을 허용하는 수신 규칙을 대상 VPC 보안 그룹에 추가합니다. 소스 보안 그룹에는 대상 보안 그룹으로의 발신 트래픽을 허용하는 송신 규칙도 필요합니다. 원본 보안 그룹이 다른 계정에 있기 때문에 다음 예제에서는 Ref 함수를 사용하여 원본 보안 그룹 ID를 참조하지 않고 대신 보안 그룹 ID를 직접 지정합니다 `sg-12345678`.

#### JSON (영문)

```
{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Resources": {
        "TargetSG": {
            "Type": "AWS::EC2::SecurityGroup",
            "Properties": {
                "VpcId": "vpc-1a2b3c4d",
                "GroupDescription": "Security group allowing ingress for security scanners"
            }
        },
        "InboundRule": {
            "Type": "AWS::EC2::SecurityGroupIngress",
            "Properties": {
                "GroupId": {
                    "Fn::GetAtt": [
                        "TargetSG",
                        "GroupId"
                    ]
                },
                "IpProtocol": "tcp",
                "FromPort": 80,
                "ToPort": 80,
                "SourceSecurityGroupId": "sg-12345678",
                "SourceSecurityGroupOwnerId": "123456789012"
            }
        }
    }
}
```
