# AWS::AutoScaling::LaunchConfiguration

이 `AWS::AutoScaling::LaunchConfiguration` 리소스는 Auto Scaling 그룹에서 Amazon EC2 인스턴스를 구성하는 데 사용할 수 있는 시작 구성을 지정합니다.

오토 스케일링에 대한 시작 구성을 업데이트하면 CloudFormation은 해당 리소스를 삭제하고 업데이트된 속성과 새 이름으로 새 시작 구성을 생성합니다. 기존 인스턴스는 영향을 받지 않습니다. 리소스를 업데이트할 때 기존 인스턴스를 업데이트하려면 `AWS::AutoScaling::LaunchConfiguration` 그룹에 대한 UpdatePolicy 속성을 지정할 수 있습니다. 롤링 업데이트에 대한 샘플 업데이트 정책은 Auto Scaling 템플릿 코드 조각에서 확인할 수 있습니다.

**메모**  
Amazon EC2 Auto Scaling은 시작 템플릿 또는 시작 구성을 사용하여 오토 스케일링의 일부로 시작된 인스턴스를 구성합니다. 시작 구성을 사용하지 않는 것이 좋습니다. Amazon EC2 Auto Scaling 또는 Amazon EC2에 대한 전체 기능을 제공하지는 않습니다. 자세한 내용은 Amazon EC2 Auto Scaling 사용 설명서의 시작 구성 및 시작 구성에서 시작 템플릿으로 AWS CloudFormation 스택 마이그레이션을 참조하세요\*\*.

## 통사론

AWS CloudFormation 템플릿에서 이 엔터티를 선언하려면 다음 구문을 사용합니다.

### JSON (영문)

```
{
  "Type" : "AWS::AutoScaling::LaunchConfiguration",
  "Properties" : {
      "AssociatePublicIpAddress" : Boolean,
      "BlockDeviceMappings" : [ BlockDeviceMapping, ... ],
      "ClassicLinkVPCId" : String,
      "ClassicLinkVPCSecurityGroups" : [ String, ... ],
      "EbsOptimized" : Boolean,
      "IamInstanceProfile" : String,
      "ImageId" : String,
      "InstanceId" : String,
      "InstanceMonitoring" : Boolean,
      "InstanceType" : String,
      "KernelId" : String,
      "KeyName" : String,
      "LaunchConfigurationName" : String,
      "MetadataOptions" : MetadataOptions,
      "PlacementTenancy" : String,
      "RamDiskId" : String,
      "SecurityGroups" : [ String, ... ],
      "SpotPrice" : String,
      "UserData" : String
    }
}
```

## 속성

`AssociatePublicIpAddress`  
그룹의 인스턴스에 공용 IPv4 주소를 할당할지 여부를 지정합니다. 인스턴스가 기본 서브넷에서 시작되는 경우, 서브넷에 퍼블릭 IPv4 주소를 할당하는 옵션을 비활성화하지 않는 한 기본값은 퍼블릭 IPv4 주소를 할당하는 것입니다. 인스턴스가 기본이 아닌 서브넷으로 시작되는 경우, 서브넷에 퍼블릭 IPv4 주소를 할당하는 옵션을 활성화하지 않는 한 기본값은 퍼블릭 IPv4 주소를 할당하지 않는 것입니다.  
를 지정하면 `true`오토 스케일링의 각 인스턴스가 고유한 퍼블릭 IPv4 주소를 수신합니다. 자세한 내용은 *Amazon EC2 Auto Scaling 사용 설명서*의 VPC에서 Auto Scaling 인스턴스 시작을 참조하세요.  
이 특성을 지정하는 경우, 그룹을 작성할 때 하나 이상의 서브넷을 지정해야 `VPCZoneIdentifier` 합니다.  
*필수 항목 *여부: 아니요  
_유형_: Boolean  
_업데이트 필요 사항_: 바꿔 놓음

`BlockDeviceMappings`  
시작 시 인스턴스에 연결할 블록 장치를 정의하는 블록 장치 매핑 항목입니다. 기본적으로 AMI에 대한 블록 장치 매핑에 지정된 블록 장치가 사용됩니다. 자세한 내용은 _Linux 인스턴스용 Amazon EC2 사용 설명서의 블록 디바이스 매핑을 참조하세요_.  
*필수 항목 *여부: 아니요  
_형식_: BlockDeviceMapping 목록  
_업데이트 필요 사항_: 바꿔 놓음

`ClassicLinkVPCId`  
이전 버전과의 호환성을 위해 사용할 수 있습니다.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 바꿔 놓음

`ClassicLinkVPCSecurityGroups`  
이전 버전과의 호환성을 위해 사용할 수 있습니다.  
_필수_: 조건부  
_유형_: 문자열 목록  
_업데이트 필요 사항_: 바꿔 놓음

`EbsOptimized`  
시작 구성이 EBS I/O()에 최적화되었는지 `true`여부를`false` 지정합니다(). 최적화는 Amazon EBS에 전용 처리량과 최적화된 구성 스택을 제공하여 최적의 I/O 성능을 제공합니다. 이 최적화는 모든 인스턴스 유형에서 사용할 수 있는 것은 아닙니다. 기본적으로 EBS에 최적화되지 않은 인스턴스 유형에 대해 EBS 최적화를 활성화하면 추가 요금이 발생합니다. 자세한 내용은 *Linux 인스턴스용 Amazon EC2 사용 설명서*의 Amazon EBS 최적화 인스턴스를 참조하세요.  
기본값은 `false`입니다.  
*필수 항목 *여부: 아니요  
_유형_: Boolean  
_업데이트 필요 사항_: 바꿔 놓음

`IamInstanceProfile`  
인스턴스의 IAM 역할과 연결된 인스턴스 프로파일의 이름 또는 Amazon 리소스 이름(ARN)입니다. 인스턴스 프로파일에는 IAM 역할이 포함되어 있습니다. 자세한 내용은 _Amazon EC2 Auto Scaling 사용 설명서의 Amazon EC2 인스턴스에서 실행되는 애플리케이션의 IAM 역할을 참조하세요_.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 바꿔 놓음

`ImageId`  
등록 중에 할당된 Amazon 머신 이미지(AMI)의 ID입니다. 자세한 내용은 _Linux 인스턴스용 Amazon EC2 사용 설명서의 Linux AMI 찾기를 참조하십시오_.  
를 지정하는 경우 `InstanceId`an `ImageId` 은 필요하지 않습니다.  
_필수_: 조건부  
_유형_: 문자열  
_업데이트 필요 사항_: 바꿔 놓음

`InstanceId`  
시작 구성을 생성하는 데 사용할 Amazon EC2 인스턴스의 ID입니다. 인스턴스를 사용하여 시작 구성을 만드는 경우 및 를 제외한 모든 속성이 인스턴스에서 파생 `BlockDeviceMapping` `AssociatePublicIpAddress` 됩니다. 인스턴스의 모든 속성은 시작 구성에서 지정하여 재정의할 수 있습니다.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 바꿔 놓음

`InstanceMonitoring`  
이 그룹의 인스턴스가 상세(`true`) 또는 기본(`false`) 모니터링으로 시작되는지 여부를 제어합니다.  
기본값은 `true` (enabled)입니다.  
세부 모니터링이 활성화되면 Amazon CloudWatch는 매분 지표를 생성하고 계정에 요금이 부과됩니다. 세부 모니터링을 비활성화하면 CloudWatch는 5분마다 지표를 생성합니다. 자세한 내용은 _Amazon EC2 Auto Scaling 사용 설명서의 Auto Scaling 인스턴스에 대한 모니터링 구성을 참조하십시오_.
*필수 항목 *여부: 아니요  
_유형_: Boolean  
_업데이트 필요 사항_: 바꿔 놓음

`InstanceType`  
EC2 인스턴스의 인스턴스 유형을 지정합니다. 사용 가능한 인스턴스 유형에 대한 자세한 내용은 _Linux 인스턴스용 Amazon EC2 사용 설명서의 사용 가능한 인스턴스 유형을 참조하세요_.  
를 지정하는 경우 `InstanceId`an `InstanceType` 은 필요하지 않습니다.  
_필수_: 조건부  
_유형_: 문자열  
_업데이트 필요 사항_: 바꿔 놓음

`KernelId`  
AMI와 연결된 커널의 ID입니다.  
커널 및 RAM 디스크 대신 PV-GRUB을 사용하는 것이 좋습니다. 자세한 내용은 _Linux 인스턴스용 Amazon EC2 사용 설명서의 사용자 제공 커널을 참조하세요_.
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 바꿔 놓음

`KeyName`  
키 페어의 이름입니다. 자세한 내용은 _Linux 인스턴스용 Amazon EC2 사용 설명서의 Amazon EC2 키 페어 및 Linux 인스턴스를 참조하세요_.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 바꿔 놓음

`LaunchConfigurationName`  
시작 구성의 이름입니다. 이 이름은 계정별로 리전별로 고유해야 합니다.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_최소_: `1`  
_최대_: `255`  
_패턴_: `[u0020-uD7FFuE000-uFFFDuD800uDC00-uDBFFuDFFFrnt]*`  
_업데이트 필요 사항_: 바꿔 놓음

`MetadataOptions`  
인스턴스에 대한 메타데이터 옵션입니다. 자세한 내용은 _Amazon EC2 Auto Scaling 사용 설명서의 인스턴스 메타데이터 옵션 구성을 참조하십시오_.  
*필수 항목 *여부: 아니요  
_형식_: MetadataOptions  
_업데이트 필요 사항_: 바꿔 놓음

`PlacementTenancy`  
인스턴스의 테넌시( `default` 또는 `dedicated`. `dedicated` 테넌시가 있는 인스턴스는 격리된 단일 테넌트 하드웨어에서 실행되며 VPC에서만 시작할 수 있습니다. 공유 테넌시 VPC(인스턴스 배치 테넌시 속성이 로 설정된 VPC)에서 전용 인스턴스를 시작하려면 `default`이 속성의 값을 로 설정해야 합니다`dedicated`. 자세한 내용은 Amazon EC2 Auto Scaling 사용 설명서의 Amazon EC2 Auto Scaling을 사용하여 인스턴스 테넌시 구성을 참조하세요\**.  
를 지정하는 경우 `PlacementTenancy` 그룹을 생성할 때 하나 이상의 서브넷을 지정해야 `VPCZoneIdentifier` 합니다.  
유효한 값: `default` | `dedicated`  
*필수 항목 *여부: 아니요  
*유형*: 문자열  
*업데이트 필요 사항\*: 바꿔 놓음

`RamDiskId`  
선택할 RAM 디스크의 ID입니다.  
커널 및 RAM 디스크 대신 PV-GRUB을 사용하는 것이 좋습니다. 자세한 내용은 _Linux 인스턴스용 Amazon EC2 사용 설명서의 사용자 제공 커널을 참조하세요_.
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 바꿔 놓음

`SecurityGroups`  
Auto Scaling 그룹의 인스턴스에 할당할 보안 그룹이 포함된 목록입니다. 목록에는 기존 보안 그룹의 ID와 템플릿에서 만든 SecurityGroup 리소스에 대한 참조가 모두 포함될 수 있습니다.  
자세한 내용은 _Amazon Virtual Private Cloud 사용 설명서의 보안 그룹을 사용하여 리소스에 대한 트래픽 제어를 참조하세요_.  
*필수 항목 *여부: 아니요  
_유형_: 문자열 목록  
_업데이트 필요 사항_: 바꿔 놓음

`SpotPrice`  
요청을 이행하기 위해 시작된 스팟 인스턴스에 대해 지불해야 하는 최대 시간당 요금입니다. 스팟 인스턴스는 지정한 가격이 현재 스팟 가격을 초과할 때 시작됩니다. 자세한 내용은 Amazon EC2 Auto Scaling 사용 설명서의 내결함성 및 유연한 애플리케이션을 위한 스팟 인스턴스 요청을 참조하십시오\**.  
유효 범위: 최소값 0.001  
새 시작 구성을 생성하여 최고 가격을 변경하는 경우, 실행 중인 인스턴스의 최고 가격이 현재 스팟 가격보다 높으면 실행 중인 인스턴스가 계속 실행됩니다.
*필수 항목 *여부: 아니요  
*유형*: 문자열  
*업데이트 필요 사항\*: 바꿔 놓음

`UserData`  
시작된 EC2 인스턴스에서 사용할 수 있도록 Base64로 인코딩된 사용자 데이터입니다. 자세한 내용은 _Linux 인스턴스용 Amazon EC2 사용 설명서의 인스턴스 메타데이터 및 사용자 데이터를 참조하세요_.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_최대_: `21847`  
_패턴_: `[u0020-uD7FFuE000-uFFFDuD800uDC00-uDBFFuDFFFrnt]*`  
_업데이트 필요 사항_: 바꿔 놓음

## 반환 값

### 참고문헌

이 리소스의 논리적 ID가 `Ref` 내장 함수 에 제공되면 `Ref` 리소스 이름을 반환합니다. 예를 들면 다음과 같습니다`mystack-mylaunchconfig-1DDYF1E3B3I`.

함수 사용에 대한 자세한 `Ref` 내용은 Ref를 참조하세요.

## 발언

CloudFormation은 원하는 용량에 도달하면 오토 스케일링을 성공으로 표시합니다(상태를 CREATE_COMPLETE로 설정). 그러나 `SpotPrice` 시작 구성에서 설정된 경우 원하는 용량이 성공 기준으로 사용되지 않습니다. 요청이 이행되는지 여부는 스팟 인스턴스 용량과 최고 가격에 따라 달라집니다. 현재 스팟 가격이 지정된 최고 가격보다 낮은 경우 Amazon EC2 Auto Scaling은 원하는 용량을 그룹의 목표 용량으로 사용합니다. 스팟 인스턴스에 대한 요청이 실패하면 계속 시도합니다.

Auto Scaling 인스턴스가 퍼블릭 IPv4 주소를 수신하고 동일한 스택 템플릿에 정의된 VPC에서 시작되는 경우 DependsOn 속성을 사용하여 VPC 게이트웨이 연결에 대한 종속성을 선언해야 합니다.

## 예제

다음 예제에서는 Auto Scaling 그룹에서 Amazon EC2 인스턴스를 구성하는 데 사용할 수 있는 시작 구성을 생성합니다.

**메모**  
Amazon EC2 시작 템플릿의 예는 리소스의 예제 섹션을 참조하십시오 `AWS::EC2::LaunchTemplate` .

### Amazon EBS 지원 AMI 및 정의된 블록 디바이스 매핑

이 예제에서는 `BlockDeviceMappings` /dev/sda1에 매핑된 30GB EBS 루트 볼륨과 /dev/sdm에 매핑된 100GB EBS 볼륨이라는 두 개의 디바이스를 나열하는 속성이 있는 시작 구성을 보여줍니다. /dev/sdm 볼륨은 리전에 따라 기본 EBS 볼륨 유형을 사용하며, 연결된 인스턴스를 종료할 때 삭제되지 않습니다.

CloudFormation은 AWS Systems Manager 파라미터 스토어의 파라미터를 지원합니다. 이 예제에서 `ImageId` 속성은 Parameter Store의 최신 Amazon Linux 2 AMI(EBS 지원 이미지)를 참조합니다. 자세한 내용은 *AWS Systems Manager 사용 설명서*의 AWS Systems Manager 파라미터 스토어 및 AWS 컴퓨팅 블로그의 블로그 게시물 AWS Systems Manager 파라미터 스토어를 사용하여 최신 Amazon Linux AMI ID에 대한 쿼리를 참조하세요.

#### JSON (영문)

```
{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Parameters": {
    "LatestAmiId": {
      "Description": "Region specific image from the Parameter Store",
      "Type": "AWS::SSM::Parameter::Value&lt;AWS::EC2::Image::Id>",
      "Default": "/aws/service/ami-amazon-linux-latest/amzn2-ami-hvm-x86_64-gp2"
    },
    "InstanceType": {
      "Description": "Amazon EC2 instance type for the instances",
      "Type": "String",
      "AllowedValues": [
        "t3.micro",
        "t3.small",
        "t3.medium"
      ],
      "Default": "t3.micro"
    }
  },
  "Resources":{
    "myLaunchConfig":{
      "Type":"AWS::AutoScaling::LaunchConfiguration",
      "Properties":{
        "ImageId":{ "Ref":"LatestAmiId" },
        "SecurityGroups":[ { "Ref":"myEC2SecurityGroup" } ],
        "InstanceType":{ "Ref":"InstanceType" },
        "BlockDeviceMappings":[
          {
            "DeviceName":"/dev/sda1",
            "Ebs":{
              "VolumeSize":"30",
              "VolumeType":"gp3"
            }
          },
          {
            "DeviceName":"/dev/sdm",
            "Ebs":{
              "VolumeSize":"100",
              "DeleteOnTermination":"false"
            }
          }
        ]
      }
    }
  }
}
```

### 스팟 가격 및 IAM 역할이 있는 인스턴스 스토어 지원 AMI

이 예제에서는 Auto Scaling 그룹에서 스팟 인스턴스를 시작하는 시작 구성을 보여줍니다. 이 시작 구성은 현재 스팟 가격이 템플릿 사양의 가격(0.045)보다 낮은 경우에만 활성화됩니다. 또한 속성을 사용하는 시작 구성을 보여 줍니다 `IamInstanceProfile` . 여기에서 참조되는 InstanceProfile 오브젝트의 정의 및 추가 참조를 포함한 전체 템플릿의 예 는 `RootInstanceProfile`auto_scaling_with_instance_profile.template을 참조하십시오.

이 예제에서 `ImageId` 속성은 Parameter Store의 최신 Amazon Linux AMI(인스턴스 스토어/S3 지원 이미지)를 참조합니다. BlockDeviceMappings 등록 정보는 `ephemeral0` /dev/sdc에 매핑된 가상 장치를 나열합니다.

#### JSON (영문)

```
{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Parameters": {
    "LatestAmiId": {
      "Description": "Region specific image from the Parameter Store",
      "Type": "AWS::SSM::Parameter::Value&lt;AWS::EC2::Image::Id>",
      "Default": "/aws/service/ami-amazon-linux-latest/amzn-ami-hvm-x86_64-s3"
    }
  },
  "Resources":{
    "myLaunchConfig":{
      "Type":"AWS::AutoScaling::LaunchConfiguration",
      "Properties":{
        "ImageId":{ "Ref":"LatestAmiId" },
        "SecurityGroups":[ { "Ref":"myEC2SecurityGroup" } ],
        "InstanceType":"m3.medium",
        "SpotPrice":"0.045",
        "IamInstanceProfile":{ "Ref":"RootInstanceProfile" },
        "BlockDeviceMappings": [
          {
            "DeviceName": "/dev/sdc",
            "VirtualName": "ephemeral0"
          }
        ]
      }
    }
  }
}
```

### 프로비저닝된 IOPS EBS 최적화 볼륨(키 페어 이름 및 사용자 데이터 포함)

이 예제에서는 `EbsOptmized` 프로비저닝된 IOPS EBS 최적화 볼륨으로 인스턴스를 시작하도록 속성을 구성하는 시작 구성을 보여줍니다. 이렇게 하면 EBS 지원 인스턴스의 성능이 향상될 수 있습니다.

**메모**  
기본적으로 EBS에 최적화되지 않은 인스턴스의 경우 Amazon Elastic Compute Cloud 사용 설명서의 Amazon EBS 최적화 인스턴스 설명서에 설명된 성능 수준을 달성하려면 EBS 최적화를 활성화해야 _합니다_. 현재 세대 인스턴스 유형의 경우 EBS 최적화는 추가 비용 없이 기본적으로 활성화됩니다. 기본적으로 EBS에 최적화되지 않은 이전 세대 인스턴스 유형에 대해 EBS 최적화를 활성화하면 추가 요금이 발생합니다.

이와 같은 시작 구성을 사용하는 경우 `m1.large` 인스턴스에는 AMI에서 지정한 프로비저닝된 IOPS 설정이 적용된 최적화된 EBS 루트 볼륨이 포함됩니다. 시작 구성에서 IOPS 설정을 지정할 수 없기 때문에 원하는 IOPS 수를 지정하는 블록 디바이스 매핑으로 AMI를 구성해야 합니다. 다음은 이 EBS 최적화 인스턴스 구성의 주요 속성입니다.

- 인스턴스 유형 `m1.large` 이상입니다. 이는 EBS 최적화에 필요합니다. 이 최적화는 특정 인스턴스 유형 및 크기에만 사용할 수 있습니다.
- 볼륨 유형 과 볼륨에 프로비저닝하려는 IOPS 수가 `io1` 있는 EBS 지원 AMI 입니다.
- EBS 볼륨의 크기는 필요한 IOPS를 수용해야 합니다. IOPS와 스토리지 기가바이트(GiB) 사이에는 50:1의 비율이 있습니다.

프로비저닝된 IOPS 볼륨의 IOPS 성능에 대한 자세한 내용은 `io1`Amazon Elastic Compute Cloud 사용 설명서`io2`의 프로비저닝된 IOPS SSD( 및 _) 볼륨을 참조하세요_.

더 많은 성능 팁은 Amazon Elastic Compute Cloud 사용 설명서*의 Linux 인스턴스에서의 Amazon EBS 볼륨 성능을 참조하세요*.

#### JSON (영문)

```
{
  "Resources":{
    "myLaunchConfig":{
      "Type":"AWS::AutoScaling::LaunchConfiguration",
      "Properties":{
        "ImageId":"ami-02354e95b3example",
        "SecurityGroups":[ { "Ref":"myEC2SecurityGroup" }, "myExistingEC2SecurityGroup" ],
        "InstanceType":"m1.large",
        "UserData": {"Fn::Base64": {"Fn::Join": ["", [
          "#!/bin/bash -x\n",
          "/opt/aws/bin/cfn-signal -e $? --stack ", {"Ref": "AWS::StackName"}, " --resource myASG ", " --region ", {"Ref": "AWS::Region"}, "\n"
        ]]}},
        "EbsOptimized":"true"
      }
    }
  }
}
```

## 참고 항목

- Amazon EC2 Auto Scaling 사용 설명서\* \* 의 시작 구성에서 시작 템플릿으로 AWS CloudFormation 스택 마이그레이션
- Amazon EC2 Auto Scaling API 참조*의 CreateLaunchConfiguration *
