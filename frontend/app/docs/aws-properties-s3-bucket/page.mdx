# AWS::S3::버킷

리소스는 `AWS::S3::Bucket` AWS CloudFormation 스택을 생성하는 동일한 AWS 리전에 Amazon S3 버킷을 생성합니다.

스택이 삭제될 때 AWS CloudFormation에서 버킷을 처리하는 방법을 제어하기 위해 버킷에 대한 삭제 정책을 설정할 수 있습니다. \** 버킷을 유지하거나 *삭제\*하도록 선택할 수 있습니다 . 자세한 내용은 DeletionPolicy 속성 단원을 참조하십시오.

**중요하다**  
빈 버킷만 삭제할 수 있습니다. 콘텐츠가 있는 버킷에 대한 삭제가 실패합니다.

## 통사론

AWS CloudFormation 템플릿에서 이 엔터티를 선언하려면 다음 구문을 사용합니다.

### JSON (영문)

```
{
  "Type" : "AWS::S3::Bucket",
  "Properties" : {
      "AccelerateConfiguration" : AccelerateConfiguration,
      "AccessControl" : String,
      "AnalyticsConfigurations" : [ AnalyticsConfiguration, ... ],
      "BucketEncryption" : BucketEncryption,
      "BucketName" : String,
      "CorsConfiguration" : CorsConfiguration,
      "IntelligentTieringConfigurations" : [ IntelligentTieringConfiguration, ... ],
      "InventoryConfigurations" : [ InventoryConfiguration, ... ],
      "LifecycleConfiguration" : LifecycleConfiguration,
      "LoggingConfiguration" : LoggingConfiguration,
      "MetricsConfigurations" : [ MetricsConfiguration, ... ],
      "NotificationConfiguration" : NotificationConfiguration,
      "ObjectLockConfiguration" : ObjectLockConfiguration,
      "ObjectLockEnabled" : Boolean,
      "OwnershipControls" : OwnershipControls,
      "PublicAccessBlockConfiguration" : PublicAccessBlockConfiguration,
      "ReplicationConfiguration" : ReplicationConfiguration,
      "Tags" : [Tag, ... ],
      "VersioningConfiguration" : VersioningConfiguration,
      "WebsiteConfiguration" : WebsiteConfiguration
    }
}
```

## 속성

`AccelerateConfiguration`  
Amazon S3 버킷에 대한 전송 가속화 상태를 구성합니다. 자세한 내용은 _Amazon S3 사용 설명서의 Amazon S3 Transfer Acceleration을 참조하세요_.  
*필수 항목 *여부: 아니요  
_유형_: AccelerateConfiguration  
_업데이트 필요 사항_: 중단 없음

`AccessControl`  
 이는 레거시 속성이며 대부분의 사용 사례에는 권장되지 않습니다. Amazon S3의 최신 사용 사례 대부분은 더 이상 ACL을 사용할 필요가 없으며 ACL을 비활성화된 상태로 유지하는 것이 좋습니다. 자세한 내용은 *Amazon S3 사용 설명서*의 객체 소유권 제어를 참조하세요.
버킷에 사전 정의된 권한을 부여하는 미리 준비된 ACL(액세스 제어 목록)입니다. 미리 제공된 ACL에 대한 자세한 내용은 *Amazon S3 사용 설명서*의 미리 제공 ACL을 참조하세요.  
 S3 버킷은 기본적으로 ACL이 비활성화된 상태로 생성됩니다. 따라서 ACL을 활성화하도록 AWS::S3::OwnershipControls 속성을 명시적으로 설정하지 않으면 리소스가 Private 이외의 값으로 배포되지 않습니다. ACL이 필요한 사용 사례는 일반적이지 않습니다.  
 대부분의 액세스 제어 구성은 버킷 정책을 사용하여 성공적이고 더 쉽게 달성할 수 있습니다. 자세한 내용은 AWS::S3::BucketPolicy 단원을 참조하십시오. S3 서버 액세스 로그 버킷 등을 포함한 일반적인 정책 구성의 예는 _Amazon S3 사용 설명서의 버킷 정책 예제를 참조하세요_.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 중단 없음

`AnalyticsConfigurations`  
Amazon S3 버킷의 분석 필터에 대한 구성 및 분석을 지정합니다.  
*필수 항목 *여부: 아니요  
_유형_: AnalyticsConfiguration 목록  
_업데이트 필요 사항_: 중단 없음

`BucketEncryption`  
Amazon S3 관리형 키(SSE-S3), AWS KMS 관리형 키(SSE-KMS) 또는 KMS 관리형 키를 사용한 듀얼 레이어 서버 측 암호화(DSSE-KMS)를 사용한 서버 측 암호화를 사용하여 버킷에 대한 기본 암호화를 지정합니다. Amazon S3 기본 암호화 기능에 대한 자세한 내용은 Amazon S3 사용 설명서의 S3 버킷에 대한 Amazon S3 기본 암호화를 참조하십시오\**.  
*필수 항목 *여부: 아니요  
*유형*: BucketEncryption  
*업데이트 필요 사항\*: 중단 없음

`BucketName`  
버킷의 이름입니다. 이름을 지정하지 않으면 AWS CloudFormation에서 고유 ID를 생성하고 해당 ID를 버킷 이름으로 사용합니다. 버킷 이름에는 소문자, 숫자, 마침표(.) 및 대시(-)만 포함되어야 하며 Amazon S3 버킷 제한 및 제한 사항을 따라야 합니다. 자세한 내용은 *Amazon S3 사용 설명서*의 Amazon S3 버킷 이름 지정 규칙을 참조하세요.  
이름을 지정하면 이 리소스를 대체해야 하는 업데이트를 수행할 수 없습니다. 중단이 필요 없거나 약간의 중단이 필요한 업데이트를 수행할 수 있습니다. 리소스를 바꿔야 하는 경우 새 이름을 지정합니다.
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 바꿔 놓음

`CorsConfiguration`  
Amazon S3 버킷의 객체에 대한 교차 오리진 액세스 구성을 설명합니다. 자세한 내용은 _Amazon S3 사용 설명서의 Enabling Cross-Origin Resource Sharing을 참조하십시오_.  
*필수 항목 *여부: 아니요  
_형식_: CorsConfiguration  
_업데이트 필요 사항_: 중단 없음

`IntelligentTieringConfigurations`  
Amazon S3에서 지능형 계층화 스토리지를 처리하는 방법을 정의합니다.  
*필수 항목 *여부: 아니요  
_유형_: IntelligentTieringConfiguration 목록  
_업데이트 필요 사항_: 중단 없음

`InventoryConfigurations`  
Amazon S3 버킷에 대한 인벤토리 구성을 지정합니다. 자세한 내용은 _Amazon S3 API Reference의 GET Bucket inventory를 참조하세요_.  
*필수 항목 *여부: 아니요  
_유형_: InventoryConfiguration 목록  
_업데이트 필요 사항_: 중단 없음

`LifecycleConfiguration`  
Amazon S3 버킷의 객체에 대한 수명 주기 구성을 지정합니다. 자세한 내용은 _Amazon S3 사용 설명서의 객체 수명 주기 관리를 참조하세요_.  
*필수 항목 *여부: 아니요  
_유형_: LifecycleConfiguration  
_업데이트 필요 사항_: 중단 없음

`LoggingConfiguration`  
로그가 저장되는 위치를 정의하는 설정입니다.  
*필수 항목 *여부: 아니요  
_유형_: LoggingConfiguration  
_업데이트 필요 사항_: 중단 없음

`MetricsConfigurations`  
Amazon S3 버킷의 CloudWatch 요청 지표(지표 구성 ID로 지정)에 대한 지표 구성을 지정합니다. 기존 메트릭 구성을 업데이트하는 경우 이는 기존 메트릭 구성을 완전히 대체한다는 점에 유의하세요. 유지하려는 요소를 포함하지 않으면 해당 요소가 지워집니다. 자세한 내용은 PutBucketMetricsConfiguration 섹션을 참조하세요.  
*필수 항목 *여부: 아니요  
_유형_: 메트릭 구성 목록  
_업데이트 필요 사항_: 중단 없음

`NotificationConfiguration`  
Amazon S3가 버킷 알림을 처리하는 방법을 정의하는 구성입니다.  
*필수 항목 *여부: 아니요  
_형식_: NotificationConfiguration  
_업데이트 필요 사항_: 중단 없음

`ObjectLockConfiguration` 지정된 버킷에 객체 잠금 구성을 배치합니다. 객체 잠금 구성에 지정된 규칙은 지정된 버킷에 배치된 모든 새 객체에 기본적으로 적용됩니다. 자세한 내용은 개체 잠금을 참조하십시오.

- 설정에는 `DefaultRetention` 모드와 마침표가 모두 필요합니다.
- 기간은 `DefaultRetention` 또는 중 `Days` 하나일 수 `Years` 있지만 하나를 선택해야 합니다. `Days` 동시에 and를 `Years` 지정할 수 없습니다 .
- 새 버킷에 대해서만 객체 잠금을 활성화할 수 있습니다. 기존 버킷에 대해 객체 잠금을 활성화하려면 AWS Support에 문의하십시오.
  *필수 항목 *여부: 아니요  
  _형식_: ObjectLockConfiguration  
  _업데이트 필요 사항_: 중단 없음

`ObjectLockEnabled`  
이 버킷에 객체 잠금 구성이 활성화되어 있는지 여부를 나타냅니다. 버킷에 `ObjectLockEnabled` 적용할 때 활성화 `ObjectLockConfiguration` 합니다.  
*필수 항목 *여부: 아니요  
_유형_: Boolean  
_업데이트 필요 사항_: 바꿔 놓음

`OwnershipControls`  
Amazon S3에서 객체 소유권 규칙을 처리하는 방법을 정의하는 구성입니다.  
*필수 항목 *여부: 아니요  
_형식_: OwnershipControls  
_업데이트 필요 사항_: 중단 없음

`PublicAccessBlockConfiguration`  
Amazon S3가 퍼블릭 액세스를 처리하는 방법을 정의하는 구성입니다.  
*필수 항목 *여부: 아니요  
_형식_: PublicAccessBlockConfiguration  
_업데이트 필요 사항_: 중단 없음

`ReplicationConfiguration`  
S3 버킷에서 객체를 복제하기 위한 구성입니다. 복제를 사용하려면 속성을 사용하여 버전 관리도 사용하도록 설정해야 합니다 `VersioningConfiguration` .  
Amazon S3는 복제된 객체를 단일 대상 버킷 또는 여러 대상 버킷에 저장할 수 있습니다. 대상 버킷이 이미 존재해야 합니다.  
*필수 항목 *여부: 아니요  
_유형_: ReplicationConfiguration  
_업데이트 필요 사항_: 중단 없음

`Tags`  
이 S3 버킷에 대한 임의의 태그 세트(키-값 페어)입니다.  
*필수 항목 *여부: 아니요  
_유형_: 태그 목록  
_업데이트 필요 사항_: 중단 없음

`VersioningConfiguration`  
이 버킷에 있는 모든 객체의 여러 버전을 활성화합니다. 버전 관리를 활성화하여 객체가 실수로 삭제되거나 덮어쓰는 것을 방지하거나 이전 버전을 검색할 수 있도록 객체를 보관할 수 있습니다.  
*필수 항목 *여부: 아니요  
_형식_: VersioningConfiguration  
_업데이트 필요 사항_: 중단 없음

`WebsiteConfiguration`  
버킷을 정적 웹 사이트로 구성하는 데 사용되는 정보입니다. 자세한 내용은 Amazon S3에서 웹 사이트 호스팅을 참조하십시오.  
*필수 항목 *여부: 아니요  
_유형_: WebsiteConfiguration  
_업데이트 필요 사항_: 중단 없음

## 반환 값

### 참고문헌

이 리소스의 논리적 ID를 내장 함수에 전달하면 `Ref` `Ref`버킷 이름이 반환됩니다.

본보기: `DOC-EXAMPLE-BUCKET`

함수 사용에 대한 자세한 `Ref`내용은 Ref를 참조하세요.

### Fn::GetAtt

`Fn::GetAtt`내장 함수는 이 형식의 지정된 특성에 대한 값을 반환합니다. 다음은 사용 가능한 특성 및 샘플 반환 값입니다.

내장 함수 사용에 대한 자세한 `Fn::GetAtt`내용은 Fn::GetAtt 단원을 참조하십시오.

####

`Arn`  
지정된 버킷의 Amazon 리소스 이름(ARN)을 반환합니다.  
본보기: `arn:aws:s3:::DOC-EXAMPLE-BUCKET`

`DomainName`  
지정된 버킷의 IPv4 DNS 이름을 반환합니다.  
본보기: `DOC-EXAMPLE-BUCKET.s3.amazonaws.com`

`DualStackDomainName`  
지정된 버킷의 IPv6 DNS 이름을 반환합니다.  
본보기: ` DOC-EXAMPLE-BUCKET.s3.dualstack.us-east-2.amazonaws.com`  
듀얼 스택 엔드포인트에 대한 자세한 내용은 Amazon S3 듀얼 스택 엔드포인트 사용 단원을 참조하십시오.

`RegionalDomainName`  
지정된 버킷의 리전 도메인 이름을 반환합니다.  
본보기: `DOC-EXAMPLE-BUCKET.s3.us-east-2.amazonaws.com`

`WebsiteURL`  
지정된 버킷에 대한 Amazon S3 웹 사이트 엔드포인트를 반환합니다.  
예(IPv4): `some-address   
Example (IPv6): `some-address

## 예제

### S3 버킷 생성

다음 예제에서는 삭제 정책을 사용하여 S3 버킷을 생성합니다 `Retain` .

#### JSON (영문)

```
{
    "Resources": {
        "S3Bucket": {
            "Type": "AWS::S3::Bucket",
            "DeletionPolicy": "Retain",
            "Properties": {
                "BucketName": "DOC-EXAMPLE-BUCKET"
            }
        }
    }
}
```

### 복제 구성 IAM 역할을 S3 버킷과 연결

다음 예제에서는 S3 버킷을 생성하고 AWS Identity and Access Management(IAM) 역할을 사용하여 복제 버킷에 쓸 수 있는 권한을 부여합니다. 순환 종속성을 피하기 위해 역할의 정책은 별도의 리소스로 선언됩니다. 버킷은 역할에 따라 다릅니다 `WorkItemBucketBackupRole` . 정책이 역할에 포함된 경우 역할도 버킷에 따라 달라집니다.

#### JSON (영문)

```
{
    "Resources": {
        "RecordServiceS3Bucket": {
            "Type": "AWS::S3::Bucket",
            "DeletionPolicy": "Retain",
            "Properties": {
                "ReplicationConfiguration": {
                    "Role": {
                        "Fn::GetAtt": [
                            "WorkItemBucketBackupRole",
                            "Arn"
                        ]
                    },
                    "Rules": [
                        {
                            "Destination": {
                                "Bucket": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "arn:aws:s3:::",
                                            {
                                                "Fn::Join": [
                                                    "-",
                                                    [
                                                        {
                                                            "Ref": "AWS::Region"
                                                        },
                                                        {
                                                            "Ref": "AWS::StackName"
                                                        },
                                                        "replicationbucket"
                                                    ]
                                                ]
                                            }
                                        ]
                                    ]
                                },
                                "StorageClass": "STANDARD"
                            },
                            "Id": "Backup",
                            "Prefix": "",
                            "Status": "Enabled"
                        }
                    ]
                },
                "VersioningConfiguration": {
                    "Status": "Enabled"
                }
            }
        },
        "WorkItemBucketBackupRole": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": [
                                "sts:AssumeRole"
                            ],
                            "Effect": "Allow",
                            "Principal": {
                                "Service": [
                                    "s3.amazonaws.com"
                                ]
                            }
                        }
                    ]
                }
            }
        },
        "BucketBackupPolicy": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": [
                                "s3:GetReplicationConfiguration",
                                "s3:ListBucket"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "arn:aws:s3:::",
                                            {
                                                "Ref": "RecordServiceS3Bucket"
                                            }
                                        ]
                                    ]
                                }
                            ]
                        },
                        {
                            "Action": [
                                "s3:GetObjectVersion",
                                "s3:GetObjectVersionAcl"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "arn:aws:s3:::",
                                            {
                                                "Ref": "RecordServiceS3Bucket"
                                            },
                                            "/*"
                                        ]
                                    ]
                                }
                            ]
                        },
                        {
                            "Action": [
                                "s3:ReplicateObject",
                                "s3:ReplicateDelete"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "arn:aws:s3:::",
                                            {
                                                "Fn::Join": [
                                                    "-",
                                                    [
                                                        {
                                                            "Ref": "AWS::Region"
                                                        },
                                                        {
                                                            "Ref": "AWS::StackName"
                                                        },
                                                        "replicationbucket"
                                                    ]
                                                ]
                                            },
                                            "/*"
                                        ]
                                    ]
                                }
                            ]
                        }
                    ]
                },
                "PolicyName": "BucketBackupPolicy",
                "Roles": [
                    {
                        "Ref": "WorkItemBucketBackupRole"
                    }
                ]
            }
        }
    }
}
```

### S3 버킷에 대한 퍼블릭 액세스 권한 부여

새 버킷을 생성하면 모든 퍼블릭 액세스 차단 설정이 자동으로 사용 설정됩니다. 모든 퍼블릭 액세스 차단 설정을 사용하도록 설정하는 것이 좋습니다. 버킷에 대한 일정 수준의 퍼블릭 액세스가 필요한 경우 퍼블릭 액세스 차단 설정을 비활성화할 수 있습니다. 다음 예제에서는 퍼블릭 액세스 차단(Block Public Access)이라는 버킷을 생성 `my-bucket` 한 다음 비활성화하는 방법을 보여 줍니다. 그런 다음 퍼블릭 버킷 정책이 버킷에 추가됩니다.

**메모**  
다음 예제에서는 `BlockPublicPolicy` 및 `RestrictPublicBuckets` 퍼블릭 액세스 차단 설정이 계정 수준에서 비활성화되었다고 가정합니다.

#### JSON (영문)

```
        {
          "Resources": {
            "MyBucket": {
              "Type": "AWS::S3::Bucket",
              "Properties": {
                "BucketName": "my-bucket",
                "PublicAccessBlockConfiguration": {
                  "BlockPublicAcls": false,
                  "BlockPublicPolicy": false,
                  "IgnorePublicAcls": false,
                  "RestrictPublicBuckets": false

                }
              }
            },
            "MyBucketPolicy": {
              "Type": "AWS::S3::BucketPolicy",
              "Properties": {
                "Bucket": {
                  "Ref": "MyBucket"
                },
                "PolicyDocument": {
                  "Version": "2012-10-17",
                  "Statement": [
                    {
                       "Effect": "Allow",
                       "Principal": "*",
                       "Action": "s3:GetObject",
                       "Resource": {
                         "Fn::Join": [
                           "",
                           [
                             "arn:aws:s3:::",
                             {
                               "Ref": "MyBucket"
                             },
                             "/*"
                           ]
                         ]
                       }
                     }
                   ]
                 }
               }
             }
           }
         }
```

### ACL 활성화

기본적으로 S3 객체 소유권은 로 설정 `BucketOwnerEnforced` 되고 ACL은 비활성화됩니다. S3의 최신 사용 사례 대부분은 더 이상 ACL을 사용할 필요가 없으며 ACL을 비활성화된 상태로 유지하는 것이 좋습니다. ACL을 사용 중지하면 누가 버킷에 객체를 업로드했는지에 관계없이 버킷의 모든 객체에 대한 액세스를 제어할 수 있습니다. 특정 사용 사례에서 ACL을 활성화해야 하는 경우 S3 객체 소유권을 또는 로 설정할 수 있습니다 `BucketOwnerPreferred` `ObjectWriter`. 자세한 내용은 _Amazon S3 사용 설명서의 객체 소유권 제어 및 ACL 비활성화를 참조하세요_.

다음 예에서는 객체 소유권이 로 설정된 것을 보여 줍니다 `BucketOwnerPreferred`.

#### JSON (영문)

```
        {
          "Resources": {
            "MyBucket": {
              "Type": "AWS::S3::Bucket",
              "Properties": {
                "BucketName": "my-bucket",
                "OwnershipControls": {
                       "Rules": [
                           {
                               "ObjectOwnership": "BucketOwnerPreferred"
                           }
                       ]
                   }
                "AccessControl" : "AwsExecRead"
              }
           }
         }
       }
```

### 회람 규칙을 사용하여 정적 웹 사이트 구성Configure a static website with a routing rule

이 예제에서는 `AWS::S3::Bucket's Fn::GetAtt` 값을 사용하여 출력을 제공합니다. HTTP 404 오류가 발생하면 라우팅 규칙은 요청을 EC2 인스턴스로 리디렉션하고 리디렉션에 객체 키 접두사를 삽입 `report-404/` 합니다. 예를 들어 호출된 페이지를 요청 `ExamplePage.html` 했는데 HTTP 404 오류가 발생하는 경우 요청은 지정된 인스턴스에서 호출된 페이지로 라우팅 `report-404/ExamplePage.html` 됩니다. 다른 모든 HTTP 오류 코드의 경우 `error.html` 가 반환됩니다.

또한 이 예제에서는 `EntireBucket` 버킷 수준에서 CloudWatch 요청 지표를 활성화하는 지표 구성을 지정합니다.

#### JSON (영문)

```
{
    "Resources": {
        "S3Bucket": {
            "Type": "AWS::S3::Bucket",
            "Properties": {
                "AccessControl": "PublicRead",
                "BucketName": "public-bucket",
                "MetricsConfigurations": [
                    {
                        "Id": "EntireBucket"
                    }
                ],
                "WebsiteConfiguration": {
                    "IndexDocument": "index.html",
                    "ErrorDocument": "error.html",
                    "RoutingRules": [
                        {
                            "RoutingRuleCondition": {
                                "HttpErrorCodeReturnedEquals": "404",
                                "KeyPrefixEquals": "out1/"
                            },
                            "RedirectRule": {
                                "HostName": "ec2-11-22-333-44.compute-1.amazonaws.com",
                                "ReplaceKeyPrefixWith": "report-404/"
                            }
                        }
                    ]
                }
            },
            "DeletionPolicy": "Retain"
        }
    },
    "Outputs": {
        "WebsiteURL": {
            "Value": {
                "Fn::GetAtt": [
                    "S3Bucket",
                    "WebsiteURL"
                ]
            },
            "Description": "URL for website hosted on S3"
        },
        "S3BucketSecureURL": {
            "Value": {
                "Fn::Join": [
                    "",
                    [
                        "https://",
                        {
                            "Fn::GetAtt": [
                                "S3Bucket",
                                "DomainName"
                            ]
                        }
                    ]
                ]
            },
            "Description": "Name of S3 bucket to hold website content"
        }
    }
}
```

### Cross-Origin 리소스 공유 사용

다음 예제 템플릿은 두 개의 교차 오리진 리소스 공유 규칙이 있는 퍼블릭 S3 버킷을 보여줍니다.

#### JSON (영문)

```
{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Resources": {
        "S3Bucket": {
            "Type": "AWS::S3::Bucket",
            "Properties": {
                "AccessControl": "PublicRead",
                "CorsConfiguration": {
                    "CorsRules": [
                        {
                            "AllowedHeaders": [
                                "*"
                            ],
                            "AllowedMethods": [
                                "GET"
                            ],
                            "AllowedOrigins": [
                                "*"
                            ],
                            "ExposedHeaders": [
                                "Date"
                            ],
                            "Id": "myCORSRuleId1",
                            "MaxAge": 3600
                        },
                        {
                            "AllowedHeaders": [
                                "x-amz-*"
                            ],
                            "AllowedMethods": [
                                "DELETE"
                            ],
                            "AllowedOrigins": [
                                "http://www.example.com",
                                "http://www.example.net"
                            ],
                            "ExposedHeaders": [
                                "Connection",
                                "Server",
                                "Date"
                            ],
                            "Id": "myCORSRuleId2",
                            "MaxAge": 1800
                        }
                    ]
                }
            }
        }
    },
    "Outputs": {
        "BucketName": {
            "Value": {
                "Ref": "S3Bucket"
            },
            "Description": "Name of the sample Amazon S3 bucket with CORS enabled."
        }
    }
}
```

### S3 객체의 수명 주기 관리

다음 예제 템플릿은 수명 주기 구성 규칙이 있는 S3 버킷을 보여줍니다. 이 규칙은 키 접두사가 있는 모든 개체에 적용됩니다 `glacier` . 객체는 하루 후에 Glacier로 전환되고 1년 후에 삭제됩니다.

#### JSON (영문)

```
{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Resources": {
        "S3Bucket": {
            "Type": "AWS::S3::Bucket",
            "Properties": {
                "AccessControl": "Private",
                "LifecycleConfiguration": {
                    "Rules": [
                        {
                            "Id": "GlacierRule",
                            "Prefix": "glacier",
                            "Status": "Enabled",
                            "ExpirationInDays": 365,
                            "Transitions": [
                                {
                                    "TransitionInDays": 1,
                                    "StorageClass": "GLACIER"
                                }
                            ]
                        }
                    ]
                }
            }
        }
    },
    "Outputs": {
        "BucketName": {
            "Value": {
                "Ref": "S3Bucket"
            },
            "Description": "Name of the sample Amazon S3 bucket with a lifecycle configuration."
        }
    }
}
```

### 특정 S3 버킷에 대한 액세스 요청 기록

다음 예제 템플릿은 두 개의 S3 버킷을 생성합니다. 버킷은 버킷 `LoggingBucket` 의 로그를 저장합니다 `S3Bucket` . 버킷에서 로그를 수신하려면 `S3Bucket` 로깅 버킷에 로그 전달 쓰기 권한이 필요합니다.

#### JSON (영문)

```
{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Resources": {
        "S3Bucket": {
            "Type": "AWS::S3::Bucket",
            "Properties": {
                "LoggingConfiguration": {
                    "DestinationBucketName": {
                        "Ref": "LoggingBucket"
                    },
                    "LogFilePrefix": "testing-logs"
                }
            }
        },
        "LoggingBucket": {
            "Type": "AWS::S3::Bucket"
        },
        "S3BucketPolicy": {
            "Type": "AWS::S3::BucketPolicy",
            "Properties": {
                "Bucket": {
                    "Ref": "LoggingBucket"
                },
                "PolicyDocument": {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Action": [
                                "s3:PutObject"
                            ],
                            "Effect": "Allow",
                            "Principal": {
                                "Service": "logging.s3.amazonaws.com"
                            },
                            "Resource": {
                                "Fn::Join": [
                                    "",
                                    [
                                        "arn:aws:s3:::",
                                        {
                                            "Ref": "LoggingBucket"
                                        },
                                        "/*"
                                    ]
                                ]
                            },
                            "Condition": {
                                "ArnLike": {
                                    "aws:SourceArn": {
                                        "Fn::GetAtt": [
                                            "S3Bucket",
                                            "Arn"
                                        ]
                                    }
                                },
                                "StringEquals": {
                                    "aws:SourceAccount": {
                                        "Fn::Sub": "${AWS::AccountId}"
                                    }
                                }
                            }
                        }
                    ]
                }
            }
        }
    },
    "Outputs": {
        "BucketName": {
            "Value": {
                "Ref": "S3Bucket"
            },
            "Description": "Name of the sample Amazon S3 bucket with a logging configuration."
        }
    }
}
```

### SNS 주제에 대한 S3 버킷 알림 수신

다음 예제 템플릿은 S3가 객체의 모든 복제본을 손실했을 때 지정된 SNS 주제로 이벤트를 전송하는 알림 구성이 있는 Amazon S3 버킷을 보여줍니다.

#### JSON (영문)

```
{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Resources": {
        "S3Bucket": {
            "Type": "AWS::S3::Bucket",
            "Properties": {
                "AccessControl": "Private",
                "NotificationConfiguration": {
                    "TopicConfigurations": [
                        {
                            "Topic": "arn:aws:sns:us-east-1:123456789012:TestTopic",
                            "Event": "s3:ReducedRedundancyLostObject"
                        }
                    ]
                }
            }
        }
    },
    "Outputs": {
        "BucketName": {
            "Value": {
                "Ref": "S3Bucket"
            },
            "Description": "Name of the sample Amazon S3 bucket with a notification configuration."
        }
    }
}
```

### 버전 관리 사용 및 개체 복제Enable versioning and replicate objects

다음 예제에서는 버전 관리와 두 개의 복제 규칙을 사용하도록 설정합니다. 규칙은 접두사 중 하나와 가 붙은 객체를 복사 `MyPrefix` `MyOtherPrefix` 하고 복사된 객체를 라는 버킷에 저장합니다 `my-replication-bucket`.

#### JSON (영문)

```
{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Resources": {
        "S3Bucket": {
            "Type": "AWS::S3::Bucket",
            "Properties": {
                "VersioningConfiguration": {
                    "Status": "Enabled"
                },
                "ReplicationConfiguration": {
                    "Role": "arn:aws:iam::123456789012:role/replication_role",
                    "Rules": [
                        {
                            "Id": "MyRule1",
                            "Status": "Enabled",
                            "Prefix": "MyPrefix",
                            "Destination": {
                                "Bucket": "arn:aws:s3:::my-replication-bucket",
                                "StorageClass": "STANDARD"
                            }
                        },
                        {
                            "Status": "Enabled",
                            "Prefix": "MyOtherPrefix",
                            "Destination": {
                                "Bucket": "arn:aws:s3:::my-replication-bucket"
                            }
                        }
                    ]
                }
            }
        }
    }
}
```

### S3 버킷에 대한 분석 및 인벤토리 구성 지정

다음 예제에서는 결과 형식 및 대상 버킷을 포함하여 S3 버킷에 대해 생성할 분석 및 인벤토리 결과를 지정합니다. 인벤토리 목록은 매주 보고서를 생성하며 각 개체의 현재 버전을 포함합니다.

#### JSON (영문)

```
{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "S3 Bucket with Inventory and Analytics Configurations",
    "Resources": {
        "Helper": {
            "Type": "AWS::S3::Bucket"
        },
        "S3Bucket": {
            "Type": "AWS::S3::Bucket",
            "Properties": {
                "AnalyticsConfigurations": [
                    {
                        "Id": "AnalyticsConfigurationId",
                        "StorageClassAnalysis": {
                            "DataExport": {
                                "Destination": {
                                    "BucketArn": {
                                        "Fn::GetAtt": [
                                            "Helper",
                                            "Arn"
                                        ]
                                    },
                                    "Format": "CSV",
                                    "Prefix": "AnalyticsDestinationPrefix"
                                },
                                "OutputSchemaVersion": "V_1"
                            }
                        },
                        "Prefix": "AnalyticsConfigurationPrefix",
                        "TagFilters": [
                            {
                                "Key": "AnalyticsTagKey",
                                "Value": "AnalyticsTagValue"
                            }
                        ]
                    }
                ],
                "InventoryConfigurations": [
                    {
                        "Id": "InventoryConfigurationId",
                        "Destination": {
                            "BucketArn": {
                                "Fn::GetAtt": [
                                    "Helper",
                                    "Arn"
                                ]
                            },
                            "Format": "CSV",
                            "Prefix": "InventoryDestinationPrefix"
                        },
                        "Enabled": true,
                        "IncludedObjectVersions": "Current",
                        "Prefix": "InventoryConfigurationPrefix",
                        "ScheduleFrequency": "Weekly"
                    }
                ]
            }
        }
    }
}
```

## 참고 항목

- Amazon S3 템플릿 코드 조각
