# AWS::ApiGateway::스테이지

`AWS::ApiGateway::Stage` 리소스는 배포를 위한 단계를 생성합니다.

## 통사론

AWS CloudFormation 템플릿에서 이 엔터티를 선언하려면 다음 구문을 사용합니다.

### JSON (영문)

```
{
  "Type" : "AWS::ApiGateway::Stage",
  "Properties" : {
      "AccessLogSetting" : AccessLogSetting,
      "CacheClusterEnabled" : Boolean,
      "CacheClusterSize" : String,
      "CanarySetting" : CanarySetting,
      "ClientCertificateId" : String,
      "DeploymentId" : String,
      "Description" : String,
      "DocumentationVersion" : String,
      "MethodSettings" : [ MethodSetting, ... ],
      "RestApiId" : String,
      "StageName" : String,
      "Tags" : [Tag, ... ],
      "TracingEnabled" : Boolean,
      "Variables" : {Key: Value, ...}
    }
}
```

## 속성

`AccessLogSetting`  
액세스 로그 형식 및 액세스 로그 대상 ARN을 포함한 액세스 로그 설정.  
*필수 항목 *여부: 아니요  
_형식_: AccessLogSetting  
_업데이트 필요 사항_: 중단 없음

`CacheClusterEnabled`  
스테이지에 대해 캐시 클러스터를 사용할 수 있는지 여부를 지정합니다.  
*필수 항목 *여부: 아니요  
_유형_: Boolean  
_업데이트 필요 사항_: 중단 없음

`CacheClusterSize`  
스테이지의 캐시 용량(GB)입니다. 캐시 크기 선택에 대한 자세한 내용은 응답성 향상을 위해 API 캐싱 활성화를 참조하세요.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_허용되는 값_: `0.5 | 1.6 | 118 | 13.5 | 237 | 28.4 | 58.2 | 6.1`  
_업데이트 필요 사항_: 중단 없음

`CanarySetting`  
이 단계의 카나리아 배포에 대한 설정입니다.  
*필수 항목 *여부: 아니요  
_형식_: CanarySetting  
_업데이트 필요 사항_: 중단 없음

`ClientCertificateId`  
API 단계에 대한 클라이언트 인증서의 식별자입니다.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 중단 없음

`DeploymentId`  
스테이지가 가리키는 디플로이먼트의 식별자입니다.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 중단 없음

`Description`  
스테이지 설명입니다.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 중단 없음

`DocumentationVersion`  
연결된 API 문서의 버전입니다.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 중단 없음

`MethodSettings`  
Stage 리소스에 대한 메서드 설정을 정의하는 맵입니다. 키(아래 참조로 지정 `/{method_setting_key` 됨)는 `{resource_path}/{http_method}` 개별 메서드 재정의 또는 `/*/*` 단계의 모든 메서드 재정의로 정의된 메서드 경로입니다.  
*필수 항목 *여부: 아니요  
_형식_: MethodSetting 목록  
_업데이트 필요 사항_: 중단 없음

`RestApiId`  
연결된 RestApi의 문자열 식별자입니다.  
_필수 항목 여부_: 예  
_유형_: 문자열  
_업데이트 필요 사항_: 바꿔 놓음

`StageName`  
단계의 이름은 API Gateway 호출의 URI(Uniform Resource Identifier)에 있는 첫 번째 경로 세그먼트입니다. 스테이지 이름에는 영숫자, 하이픈, 밑줄만 사용할 수 있습니다. 최대 길이는 128자입니다.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 바꿔 놓음

`Tags`  
태그 모음입니다. 각 태그 요소는 지정된 리소스와 연결됩니다.  
*필수 항목 *여부: 아니요  
_유형_: 태그 목록  
_업데이트 필요 사항_: 중단 없음

`TracingEnabled`  
스테이지에 대해 X-ray를 사용한 활성 추적을 활성화할지 여부를 지정합니다.  
*필수 항목 *여부: 아니요  
_유형_: Boolean  
_업데이트 필요 사항_: 중단 없음

`Variables`  
단계 변수를 정의하는 맵(문자열 간 맵)으로, 변수 이름은 키이고 변수 값은 값입니다. 변수 이름은 영숫자로 제한됩니다. 값은 다음 정규식과 일치해야 합니다. `[A-Za-z0-9-._~:/?#&=,]+`  
*필수 항목 *여부: 아니요  
_유형_: 문자열 맵  
_업데이트 필요 사항_: 중단 없음

## 반환 값

### 참고문헌

이 리소스의 논리적 ID를 intrinsic 함수에 전달하면 `Ref` `Ref`단계의 이름(예: )이 반환됩니다 `MyTestStage`.

함수 사용에 대한 자세한 `Ref`내용은 Ref를 참조하세요.

## 예제

### 스테이지 생성

다음 예제에서는 배포를 위한 단계를 생성합니다 `TestDeployment` . 이 단계에서는 API에 대한 메서드 설정도 지정합니다 `MyRestApi` .

#### JSON (영문)

```
{
    "Resources": {
        "Prod": {
            "Type": "AWS::ApiGateway::Stage",
            "Properties": {
                "StageName": "Prod",
                "Description": "Prod Stage",
                "RestApiId": {
                    "Ref": "MyRestApi"
                },
                "DeploymentId": {
                    "Ref": "TestDeployment"
                },
                "DocumentationVersion": {
                    "Ref": "MyDocumentationVersion"
                },
                "ClientCertificateId": {
                    "Ref": "ClientCertificate"
                },
                "Variables": {
                    "Stack": "Prod"
                },
                "MethodSettings": [
                    {
                        "ResourcePath": "/",
                        "HttpMethod": "GET",
                        "MetricsEnabled": "true",
                        "DataTraceEnabled": "false"
                    },
                    {
                        "ResourcePath": "/stack",
                        "HttpMethod": "POST",
                        "MetricsEnabled": "true",
                        "DataTraceEnabled": "false",
                        "ThrottlingBurstLimit": "999"
                    },
                    {
                        "ResourcePath": "/stack",
                        "HttpMethod": "GET",
                        "MetricsEnabled": "true",
                        "DataTraceEnabled": "false",
                        "ThrottlingBurstLimit": "555"
                    }
                ]
            }
        }
    }
}
```

## 참고 항목

- stage:create(_Amazon API Gateway REST API 참조)_
