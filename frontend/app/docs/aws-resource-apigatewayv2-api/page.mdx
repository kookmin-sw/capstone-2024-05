# AWS::ApiGatewayV2::Api

`AWS::ApiGatewayV2::Api` 리소스는 API를 만듭니다. WebSocket API 및 HTTP API가 지원됩니다. WebSocket API에 대한 자세한 내용은 API Gateway 개발자 안내서의 API Gateway의 WebSocket API 정보를 참조하십시오\**. HTTP API에 대한 자세한 내용은 *API Gateway 개발자 안내서의 HTTP API를 참조하십시오.\*

## 통사론

AWS CloudFormation 템플릿에서 이 엔터티를 선언하려면 다음 구문을 사용합니다.

### JSON (영문)

```
{
  "Type" : "AWS::ApiGatewayV2::Api",
  "Properties" : {
      "ApiKeySelectionExpression" : String,
      "BasePath" : String,
      "Body" : Json,
      "BodyS3Location" : BodyS3Location,
      "CorsConfiguration" : Cors,
      "CredentialsArn" : String,
      "Description" : String,
      "DisableExecuteApiEndpoint" : Boolean,
      "DisableSchemaValidation" : Boolean,
      "FailOnWarnings" : Boolean,
      "Name" : String,
      "ProtocolType" : String,
      "RouteKey" : String,
      "RouteSelectionExpression" : String,
      "Tags" : {Key: Value, ...},
      "Target" : String,
      "Version" : String
    }
}
```

## 속성

`ApiKeySelectionExpression`  
API 키 선택 식입니다. WebSocket API에 대해서만 지원됩니다. API 키 선택 표현식을 참조하십시오.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 중단 없음

`BasePath`  
가져오는 동안 API의 기본 경로를 해석하는 방법을 지정합니다. 유효한 값은 `ignore`, `prepend`, 및 `split`입니다. 기본값은 `ignore`입니다. 자세한 내용은 OpenAPI basePath 속성 설정을 참조하세요. HTTP API에 대해서만 지원됩니다.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 중단 없음

`Body`  
OpenAPI 정의입니다. HTTP API에 대해서만 지원됩니다. HTTP API를 가져오려면 `Body` 또는 `BodyS3Location`. 또는 를 지정하는 경우 `Body` `BodyS3Location` 또는 `AWS::ApiGatewayV2::Authorizer`와 같은 CloudFormation 리소스를 지정하지 마십시오`AWS::ApiGatewayV2::Route`. API Gateway는 OpenAPI와 CloudFormation 리소스의 조합을 지원하지 않습니다.  
_필수_: 조건부  
_형식_: Json  
_업데이트 필요 사항_: 중단 없음

`BodyS3Location`  
OpenAPI 정의의 S3 위치입니다. HTTP API에 대해서만 지원됩니다. HTTP API를 가져오려면 `Body` 또는 `BodyS3Location`. 또는 를 지정하는 경우 `Body` `BodyS3Location` 또는 `AWS::ApiGatewayV2::Authorizer`와 같은 CloudFormation 리소스를 지정하지 마십시오`AWS::ApiGatewayV2::Route`. API Gateway는 OpenAPI와 CloudFormation 리소스의 조합을 지원하지 않습니다.  
_필수_: 조건부  
_형식_: BodyS3Location  
_업데이트 필요 사항_: 중단 없음

`CorsConfiguration`  
CORS 구성입니다. HTTP API에 대해서만 지원됩니다. 자세한 내용은 CORS 구성을 참조하세요.  
*필수 항목 *여부: 아니요  
_유형_: Cors  
_업데이트 필요 사항_: 중단 없음

`CredentialsArn`  
이 속성은 빨리 만들기의 일부입니다. 통합에 필요한 자격 증명(있는 경우)을 지정합니다. Lambda 통합의 경우 세 가지 옵션을 사용할 수 있습니다. API Gateway가 수임할 IAM 역할을 지정하려면 역할의 Amazon 리소스 이름(ARN)을 사용합니다. 호출자의 ID가 요청에서 전달되도록 요구하려면 를 지정합니다`arn:aws:iam::*:user/*`. 지원되는 AWS 서비스에서 리소스 기반 권한을 사용하려면 를 지정합니다`null`. 현재 이 특성은 HTTP 통합에 사용되지 않습니다. HTTP API에 대해서만 지원됩니다.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 중단 없음

`Description`  
API에 대한 설명입니다.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 중단 없음

`DisableExecuteApiEndpoint`  
클라이언트가 기본 끝점을 사용하여 API를 호출할 수 있는지 여부를 지정합니다 `execute-api` . 기본적으로 클라이언트는 기본 some-address 엔드포인트를 사용하여 API를 호출할 수 있습니다. 클라이언트가 사용자 지정 도메인 이름을 사용하여 API를 호출하도록 요구하려면 기본 엔드포인트를 비활성화합니다.  
*필수 항목 *여부: 아니요  
_유형_: Boolean  
_업데이트 필요 사항_: 중단 없음

`DisableSchemaValidation`  
배포를 만들 때 모델의 유효성을 검사하지 마십시오. WebSocket API에 대해서만 지원됩니다.  
*필수 항목 *여부: 아니요  
_유형_: Boolean  
_업데이트 필요 사항_: 중단 없음

`FailOnWarnings`  
경고가 발생할 때 API 작성을 롤백할지 여부를 지정합니다. 기본적으로 경고가 발생하면 API 생성이 계속됩니다.  
*필수 항목 *여부: 아니요  
_유형_: Boolean  
_업데이트 필요 사항_: 중단 없음

`Name`  
API의 이름입니다. 또는 에 대한 OpenAPI 정의를 지정하지 않는 한 필수입니다 `Body` `S3BodyLocation`.  
_필수_: 조건부  
_유형_: 문자열  
_업데이트 필요 사항_: 중단 없음

`ProtocolType`  
API 프로토콜입니다. 유효한 값은 `WEBSOCKET` 또는 `HTTP`입니다. 또는 에 대한 OpenAPI 정의를 지정하지 않는 한 필수입니다 `Body` `S3BodyLocation`.  
_필수_: 조건부  
_유형_: 문자열  
_업데이트 필요 사항_: 바꿔 놓음

`RouteKey`  
이 속성은 빨리 만들기의 일부입니다. 를 지정하지 않으면 `routeKey`의 기본 경로가 `$default` 생성됩니다. 라우팅은 `$default` 특정 단계에서 API에 대한 모든 요청에 대한 catch-all 역할을 합니다. `$default` 경로 키는 수정할 수 없습니다. API 생성 후 라우트를 추가할 수 있으며, 추가 라우트의 라우트 키를 업데이트할 수 있습니다. HTTP API에 대해서만 지원됩니다.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 중단 없음

`RouteSelectionExpression`  
API에 대한 경로 선택 표현식입니다. HTTP API의 경우 `routeSelectionExpression` `${request.method} ${request.path}`. 제공되지 않은 경우 HTTP API의 기본값이 됩니다. 이 속성은 WebSocket API에 필요합니다.  
_필수_: 조건부  
_유형_: 문자열  
_업데이트 필요 사항_: 중단 없음

`Tags`  
태그 모음입니다. 각 태그 요소는 지정된 리소스와 연결됩니다.  
*필수 항목 *여부: 아니요  
_유형_: 문자열 맵  
_업데이트 필요 사항_: 중단 없음

`Target`  
이 속성은 빨리 만들기의 일부입니다. 빠른 생성은 통합, 기본 catch-all 경로 및 변경 사항을 자동으로 배포하도록 구성된 기본 단계가 포함된 API를 생성합니다. HTTP 통합의 경우 정규화된 URL을 지정합니다. Lambda 통합의 경우 함수 ARN을 지정합니다. 통합 유형은 각각 HTTP_PROXY 또는 AWS_PROXY입니다. HTTP API에 대해서만 지원됩니다.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 중단 없음

`Version`  
API의 버전 식별자입니다.  
*필수 항목 *여부: 아니요  
_유형_: 문자열  
_업데이트 필요 사항_: 중단 없음

## 반환 값

### 참고문헌

이 리소스의 논리적 ID를 내장 함수에 전달하면 `Ref`와 `Ref`같은 API ID를 반환합니다 `a1bcdef2gh`.

함수 사용에 대한 자세한 `Ref`내용은 Ref를 참조하세요.

### Fn::GetAtt

`Fn::GetAtt`내장 함수는 이 형식의 지정된 특성에 대한 값을 반환합니다. 다음은 사용 가능한 특성 및 샘플 반환 값입니다.

내장 함수 사용에 대한 자세한 `Fn::GetAtt`내용은 Fn::GetAtt 단원을 참조하십시오.

####

`ApiEndpoint` API의 기본 엔드포인트입니다. 예: 'some-address

`ApiId` API 식별자입니다.

## 예제

### API 생성 예시

다음 예제에서는 라는 WebSocket `Api` 리소스를 만듭니다`MyApi`.

#### JSON (영문)

```
{
    "MyApi": {
      "Type": "AWS::ApiGatewayV2::Api",
      "Properties": {
        "Name": "MyApi",
        "ProtocolType": "WEBSOCKET",
        "RouteSelectionExpression": "$request.body.action",
        "ApiKeySelectionExpression": "$request.header.x-api-key"
      }
   }
}
```

### HTTP API 빨리 만들기

다음 예제에서는 빠른 생성을 사용하여 `Api` `HttpApi` Lambda 함수와 통합된 HTTP API 리소스를 시작합니다. 빠른 생성은 통합, 기본 catch-all 경로 및 변경 사항을 자동으로 배포하도록 구성된 기본 단계가 포함된 HTTP API를 생성합니다.

**메모**  
Lambda 통합을 호출하려면 API Gateway에 필요한 권한이 있어야 합니다. 리소스 기반 정책 또는 IAM 역할을 사용하여 API Gateway에 Lambda 함수를 호출할 수 있는 권한을 부여할 수 있습니다. 자세한 내용은 * AWS Lambda 개발자 안내서*의 AWS Lambda 권한을 참조하십시오.

#### JSON (영문)

```
"HttpApi": {
    "Type": "AWS::ApiGatewayV2::Api",
    "Properties": {
        "Name": "Lambda Proxy",
        "Description": "Lambda proxy using quick create",
        "ProtocolType": "HTTP",
        "Target": "arn:aws:apigateway:{region}:lambda:path/2015-03-31/functions/arn:aws:lambda:{region}:{account-id}:function:{function-name}/invocations"
     }
}
```

## 참고 항목

- Amazon API Gateway 버전 2 API 참조*의 CreateApi *
