# AWS::ECS::태스크 정의 상태 점검

이 `HealthCheck` 속성은 컨테이너 상태 검사를 나타내는 개체를 지정합니다. 컨테이너 정의에 지정된 상태 확인 파라미터는 컨테이너 이미지에 있는 모든 Docker 상태 확인(예: 상위 이미지 또는 이미지의 Dockerfile에 지정된 파라미터)을 재정의합니다. 이 구성은 `HEALTHCHECK` docker run의 매개 변수에 매핑됩니다.

**메모**  
Amazon ECS 컨테이너 에이전트는 작업 정의에 지정된 상태 확인만 모니터링하고 보고합니다. Amazon ECS는 컨테이너 이미지에 포함되어 있고 컨테이너 정의에 지정되지 않은 Docker 상태 확인을 모니터링하지 않습니다. 컨테이너 정의에 지정된 상태 확인 파라미터는 컨테이너 이미지에 있는 모든 Docker 상태 확인을 재정의합니다.

작업이 서비스의 일부가 아닌 수동으로 실행되는 경우 작업은 상태에 관계없이 수명 주기를 계속합니다. 서비스의 일부인 작업의 경우 작업이 비정상으로 보고되면 작업이 중지되고 서비스 스케줄러가 이를 대체합니다.

다음은 컨테이너 상태 확인 지원에 대한 참고 사항입니다.

- 컨테이너 상태 확인에는 버전 1.17.0 이상의 Amazon ECS 컨테이너 에이전트가 필요합니다. 자세한 내용은 Amazon ECS 컨테이너 에이전트 업데이트 단원을 참조하십시오.
- 플랫폼 버전 1.1.0 이상을 사용하는 경우 Fargate 태스크에 대해 컨테이너 상태 확인이 지원됩니다. 자세한 내용은 AWS Fargate 플랫폼 버전을 참조하십시오.
- 컨테이너 상태 확인은 Classic Load Balancer를 사용하도록 구성된 서비스의 일부인 작업에 대해 지원되지 않습니다.

## 통사론

AWS CloudFormation 템플릿에서 이 엔터티를 선언하려면 다음 구문을 사용합니다.

### JSON (영문)

```
{
  "Command" : [ String, ... ],
  "Interval" : Integer,
  "Retries" : Integer,
  "StartPeriod" : Integer,
  "Timeout" : Integer
}
```

## 속성

`Command`  
컨테이너가 정상인지 확인하기 위해 실행하는 명령을 나타내는 string형 배열입니다. 문자열 배열은 `CMD` 명령 인수를 직접 실행하거나 `CMD-SHELL` 컨테이너의 기본 셸을 사용하여 명령을 실행하려면 다음으로 시작해야 합니다.  
 AWS Management Console JSON 패널, AWS Command Line Interface 또는 API를 사용하는 경우 명령 목록을 큰따옴표와 대괄호로 묶습니다.  
 `[ "CMD-SHELL", "curl -f some-address || exit 1" ]`  
AWS Management Console을 사용할 때는 큰따옴표와 대괄호를 포함하지 않습니다.  
 ` CMD-SHELL, curl -f some-address || exit 1`  
종료 코드 0은 성공을 나타내고 0이 아닌 종료 코드는 실패를 나타냅니다. 자세한 내용은 `HealthCheck` Docker Remote API의 컨테이너 만들기 섹션을 참조하세요.  
*필수 항목 *여부: 아니요  
_유형_: 문자열 목록  
_업데이트 필요 사항_: 바꿔 놓음

`Interval`  
각 상태 확인 실행 사이의 시간(초)입니다. 5초에서 300초 사이로 지정할 수 있습니다. 기본값은 30초입니다.  
*필수 항목 *여부: 아니요  
_유형_: Integer  
_업데이트 필요 사항_: 바꿔 놓음

`Retries`  
컨테이너가 비정상으로 간주되기 전에 실패한 상태 확인을 다시 시도하는 횟수입니다. 재시도 횟수는 1회에서 10회 사이로 지정할 수 있습니다. 기본값은 3입니다.  
*필수 항목 *여부: 아니요  
_유형_: Integer  
_업데이트 필요 사항_: 바꿔 놓음

`StartPeriod`  
상태 확인이 실패하기 전에 컨테이너에 부트스트랩 시간을 제공하는 선택적 유예 기간은 최대 재시도 횟수에 포함됩니다. 0초에서 300초 사이로 지정할 수 있습니다. 기본적으로 `startPeriod` 꺼져 있습니다.  
상태 확인이 에서 성공 `startPeriod` 하면 컨테이너가 정상으로 간주되고 이후의 모든 실패는 최대 재시도 횟수에 포함됩니다.
*필수 항목 *여부: 아니요  
_유형_: Integer  
_업데이트 필요 사항_: 바꿔 놓음

`Timeout`  
상태 확인이 실패로 간주되기 전에 성공할 때까지 대기하는 시간(초)입니다. 2초에서 60초 사이로 지정할 수 있습니다. 기본값은 5입니다.  
*필수 항목 *여부: 아니요  
_유형_: Integer  
_업데이트 필요 사항_: 바꿔 놓음

## 예제

### Amazon ECS 컨테이너 상태 확인 생성

다음 예제에서는 컨테이너 상태 확인을 생성합니다.

#### JSON (영문)

```
"HealthCheck": {
    "Command": [
        "CMD-SHELL",
	  "echo hello"
    ],
    "Interval": 5,
    "Timeout": 2,
    "Retries": 3
}
```
